
<!DOCTYPE HTML>
<html lang="id" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Praktikum 6 - Operasi Database Asynchronous Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../chapter10/chapter10-01pendahuluan.html" />
    
    
    <link rel="prev" href="chapter09-08delete.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Ketik untuk mencari" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Digital Talent Scholarship
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../chapter01/chapter01-01pendahuluan.html">
            
                <a href="../chapter01/chapter01-01pendahuluan.html">
            
                    
                    Bab 01 Activity dan Fragment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../chapter01/chapter01-01pendahuluan.html">
            
                <a href="../chapter01/chapter01-01pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../chapter01/chapter01-04helloworld.html">
            
                <a href="../chapter01/chapter01-04helloworld.html">
            
                    
                    Praktikum 1 Hello World
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../chapter01/chapter01-02activity.html">
            
                <a href="../chapter01/chapter01-02activity.html">
            
                    
                    Praktikum 2 Activity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../chapter01/chapter01-03fragment.html">
            
                <a href="../chapter01/chapter01-03fragment.html">
            
                    
                    Praktikum 3 Fragment
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chapter02/chapter02-01pendahuluan.html">
            
                <a href="../chapter02/chapter02-01pendahuluan.html">
            
                    
                    Bab 02 Android Xml Layout
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../chapter02/chapter02-01pendahuluan.html">
            
                <a href="../chapter02/chapter02-01pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../chapter02/chapter02-02linearlayout.html">
            
                <a href="../chapter02/chapter02-02linearlayout.html">
            
                    
                    Praktikum 1 Linier Layout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../chapter02/chapter02-03relativelayout.html">
            
                <a href="../chapter02/chapter02-03relativelayout.html">
            
                    
                    Praktikum 2 Relative Layout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../chapter02/chapter02-04constraintlayout.html">
            
                <a href="../chapter02/chapter02-04constraintlayout.html">
            
                    
                    Praktikum 3 Constraint Layout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../chapter02/chapter02-05latihan.html">
            
                <a href="../chapter02/chapter02-05latihan.html">
            
                    
                    Praktikum 4 Latihan Convert Layout
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../chapter03/chapter03-01pendahuluan.html">
            
                <a href="../chapter03/chapter03-01pendahuluan.html">
            
                    
                    Bab 03 Konversi Desain ke Android Xml
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../chapter03/chapter03-01pendahuluan.html">
            
                <a href="../chapter03/chapter03-01pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../chapter03/chapter03-02hasil.html">
            
                <a href="../chapter03/chapter03-02hasil.html">
            
                    
                    Hasil Yang Diharapkan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../chapter03/chapter03-03startercode.html">
            
                <a href="../chapter03/chapter03-03startercode.html">
            
                    
                    Praktikum 1 Load Starter Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../chapter03/chapter03-04splashscreen.html">
            
                <a href="../chapter03/chapter03-04splashscreen.html">
            
                    
                    Praktikum 2 Halaman Splash Screen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../chapter03/chapter03-05welcome.html">
            
                <a href="../chapter03/chapter03-05welcome.html">
            
                    
                    Praktikum 3 Halaman Welcome
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../chapter03/chapter03-06form.html">
            
                <a href="../chapter03/chapter03-06form.html">
            
                    
                    Praktikum 4 Halaman Form
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../chapter03/chapter03-07intentsplashscreen.html">
            
                <a href="../chapter03/chapter03-07intentsplashscreen.html">
            
                    
                    Praktikum 5 Intent Splash Screen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../chapter03/chapter03-08intentactivity.html">
            
                <a href="../chapter03/chapter03-08intentactivity.html">
            
                    
                    Praktikum 6 Intent Antar Activity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../chapter03/chapter03-09task01.html">
            
                <a href="../chapter03/chapter03-09task01.html">
            
                    
                    Tugas 1
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../chapter04/chapter04-pendahuluan.html">
            
                <a href="../chapter04/chapter04-pendahuluan.html">
            
                    
                    Bab 04 Validasi dan Interaksi Activity
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../chapter04/chapter04-pendahuluan.html">
            
                <a href="../chapter04/chapter04-pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../chapter04/chapter04-validasi.html">
            
                <a href="../chapter04/chapter04-validasi.html">
            
                    
                    Praktikum 1 - Validasi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../chapter04/chapter04-tugasvalidasi.html">
            
                <a href="../chapter04/chapter04-tugasvalidasi.html">
            
                    
                    Praktikum 2 - Tugas Validasi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../chapter04/chapter04-01intent.html">
            
                <a href="../chapter04/chapter04-01intent.html">
            
                    
                    Praktikum 3 - Intent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../chapter04/chapter04-02intent-explicit.html">
            
                <a href="../chapter04/chapter04-02intent-explicit.html">
            
                    
                    Praktikum 4 - Intent Explicit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../chapter04/chapter04-03intent-implicit.html">
            
                <a href="../chapter04/chapter04-03intent-implicit.html">
            
                    
                    Praktikum 5 - Intent Implicit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../chapter04/chapter04-04intent-dengan-data.html">
            
                <a href="../chapter04/chapter04-04intent-dengan-data.html">
            
                    
                    Praktikum 6 - Intent dengan Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../chapter04/chapter04-05parcelable.html">
            
                <a href="../chapter04/chapter04-05parcelable.html">
            
                    
                    Praktikum 7 - Parcelable
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../chapter05/chapter05-pendahuluan.html">
            
                <a href="../chapter05/chapter05-pendahuluan.html">
            
                    
                    Bab 05 Recycler View
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../chapter05/chapter05-pendahuluan.html">
            
                <a href="../chapter05/chapter05-pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../chapter05/chapter05-01teori.html">
            
                <a href="../chapter05/chapter05-01teori.html">
            
                    
                    Teori Recycler View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../chapter05/chapter05-02recyclerviewsangatsederhana.html">
            
                <a href="../chapter05/chapter05-02recyclerviewsangatsederhana.html">
            
                    
                    Praktikum 1 - RecyclerView Sangat Sederhana
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../chapter05/chapter05-02recyclerviewsederhana.html">
            
                <a href="../chapter05/chapter05-02recyclerviewsederhana.html">
            
                    
                    Praktikum 2 - RecyclerView Sederhana
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../chapter05/chapter05-tugas.html">
            
                <a href="../chapter05/chapter05-tugas.html">
            
                    
                    Tugas
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../chapter06/chapter06-01pendahuluan.html">
            
                <a href="../chapter06/chapter06-01pendahuluan.html">
            
                    
                    Bab 06 Project BMI
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../chapter06/chapter06-01pendahuluan.html">
            
                <a href="../chapter06/chapter06-01pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../chapter06/chapter06-02praktikum01.html">
            
                <a href="../chapter06/chapter06-02praktikum01.html">
            
                    
                    Praktikum 1 - Aplikasi BMI Sederhana part 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../chapter06/chapter06-03praktikum02.html">
            
                <a href="../chapter06/chapter06-03praktikum02.html">
            
                    
                    Praktikum 2 - Aplikasi BMI Sederhana part 2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../chapter07/00-pendahuluan.html">
            
                <a href="../chapter07/00-pendahuluan.html">
            
                    
                    Bab 07 Proyek
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../chapter07/00-pendahuluan.html">
            
                <a href="../chapter07/00-pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../chapter07/01-hasil.html">
            
                <a href="../chapter07/01-hasil.html">
            
                    
                    Hasil yang Diharapkan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../chapter07/02-proyek.html">
            
                <a href="../chapter07/02-proyek.html">
            
                    
                    Proyek
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="chapter09-01pendahuluan.html">
            
                <a href="chapter09-01pendahuluan.html">
            
                    
                    Bab 09 SharedPreferences & Room Persistence Library
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="chapter09-01pendahuluan.html">
            
                <a href="chapter09-01pendahuluan.html">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="chapter09-02teori-sharedpreferences.html">
            
                <a href="chapter09-02teori-sharedpreferences.html">
            
                    
                    Teori SharedPreferences
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="chapter09-03sharedpreferences.html">
            
                <a href="chapter09-03sharedpreferences.html">
            
                    
                    Praktikum 1 - Menyimpan & Membaca data dengan SharedPreferences
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="chapter09-04teori-room.html">
            
                <a href="chapter09-04teori-room.html">
            
                    
                    Teori Room Persistence Library
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="chapter09-05appdatabase-insert.html">
            
                <a href="chapter09-05appdatabase-insert.html">
            
                    
                    Praktikum 2 - AppDatabase & Operasi INSERT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="chapter09-06select.html">
            
                <a href="chapter09-06select.html">
            
                    
                    Praktikum 3 - Operasi SELECT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="chapter09-07update.html">
            
                <a href="chapter09-07update.html">
            
                    
                    Praktikum 4 - Operasi UPDATE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="chapter09-08delete.html">
            
                <a href="chapter09-08delete.html">
            
                    
                    Praktikum 5 - Operasi DELETE
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9.9" data-path="chapter09-09asynchronous-database-ops.html">
            
                <a href="chapter09-09asynchronous-database-ops.html">
            
                    
                    Praktikum 6 - Operasi Database Asynchronous
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../chapter10/chapter10-01pendahuluan.html">
            
                <a href="../chapter10/chapter10-01pendahuluan.html">
            
                    
                    Bab 10 Room Persistence Library, RecyclerView
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../chapter10/chapter10-02architecture-component.html">
            
                <a href="../chapter10/chapter10-02architecture-component.html">
            
                    
                    1 - Architecture Component dan Room Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../chapter10/chapter10-03MembuatViewModel.html">
            
                <a href="../chapter10/chapter10-03MembuatViewModel.html">
            
                    
                    2 - View Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../chapter10/chapter10-04RecyclerView.html">
            
                <a href="../chapter10/chapter10-04RecyclerView.html">
            
                    
                    3 - RecyclerView
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../chapter10/chapter10-05Latihan.html">
            
                <a href="../chapter10/chapter10-05Latihan.html">
            
                    
                    4 - Latihan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Dipublikasikan dengan GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Praktikum 6 - Operasi Database Asynchronous</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="praktikum-6">Praktikum-6</h1>
<h2 id="operasi-database-asynchronous">Operasi Database Asynchronous</h2>
<ol>
<li><p>Pada contoh-contoh sebelumnya, kita melakukan operasi databse secara synchronous, yaitu dalam thread tunggal. Hal ini bukanlah hal yang dianjurkan (not a best practice) karena seringkali, operasi database merupakan operasi yang menghabiskan waktu relatif lama sehingga dapat mengakibatkan UI aplikasi kita menjadi hang (not responding). </p>
<p>Untuk mencegah hal tersebut, kita dapat mengeksekusi setiap operasi database secara Asynchronous atau dengan kata lain, mengeksekusi operasi di background. Di Android kita dapat melakukan operasi asynchronous dengan bantuan class AsyncTask.</p>
<p>Pada praktikum kali ini, kita akan membuat proses Registrasi menjadi Asynchronous. Kita akan mensimulasikan proses registrasi pada aplikasi dunia nyata, yang biasanya melibatkan waktu yang lama. Bila sebelumnya, setelah registrasi langsung seketika muncul Toast, maka kali ini kita akan membuat setelah user mengklik Button &#x2018;Register&#x2019; maka akan muncul indicator loading yang akan hilang 5 detik setelah proses penyimpanan data selesai.</p>
<p>Untuk melakukannya, pertama-tama modifikasilah class AppDbProvider.java yang terdapat pada package polinema.ac.id.dtsapp.data dengan menambahkan property static baru yang akan menyimpan instance database asynchronous.</p>
<pre><code class="lang-java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DTSAppDatabase asynchronousInstance;
</code></pre>
</li>
<li><p>Kemudian tambahkan method factory baru seperti sebelumnya, untuk mendapatkan instance database asynchronous sebelumnya.</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DTSAppDatabase <span class="hljs-title">getAsynchronousInstance</span><span class="hljs-params">(Context context)</span>
</span>{
  <span class="hljs-keyword">if</span>(AppDbProvider.asynchronousInstance == <span class="hljs-keyword">null</span>)
  {
      AppDbProvider.asynchronousInstance = Room.databaseBuilder(
              context, DTSAppDatabase.class, <span class="hljs-string">&quot;dtsapp.db&quot;</span>).build();
  }

  <span class="hljs-keyword">return</span> AppDbProvider.asynchronousInstance;
}
</code></pre>
</li>
<li><p>Kemudian tambahkan file baru pada package polinema.ac.id.dtsapp.data, yaitu sebuah interface yang akan digunakan untuk menangani event-event pada saat operasi database sedang dan telah selesai dilakukan. Berinama file tersebut DatabaseTaskEventListener.java. Pada file tersebut, isikan baris-baris kode berikut.</p>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> polinema.ac.id.dtsapp.data;

<span class="hljs-keyword">import</span> android.arch.persistence.room.RoomDatabase;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DatabaseTaskEventListener</span>
</span>{
  <span class="hljs-function">Object <span class="hljs-title">runDatabaseOperation</span><span class="hljs-params">(RoomDatabase database, Object... params)</span></span>;
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onDatabaseOperationFinished</span><span class="hljs-params">(Object... results)</span></span>;
}
</code></pre>
</li>
<li><p>Selanjutnya adalah langkah yang paling penting yaitu membuat class baru bernama DatabaseTask.java yang merupakan turunan dari class AsyncTask. </p>
<p>Class ini berfungsi untuk membungkus operasi database agar dijalankan di latar belakang (background thread), alih-alih didalam thread utama. Pada class ini terdapat method-method override:</p>
<ul>
<li><strong>doInBackground()</strong> yang merupakan tempat bagi kita untuk meletakkan kode-kode yang ingin dieksekusi di latar belakang secara asynchronous.</li>
<li><strong>onPostExecute()</strong> yang merupakan tempat bagi kita untuk meletakkan kode yang ingin dieksekusi ketika proses background selesai dikerjakan.</li>
</ul>
<p>Pada class tersebut, isikan baris-baris kode berikut.</p>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> polinema.ac.id.dtsapp.data;

<span class="hljs-keyword">import</span> android.arch.persistence.room.RoomDatabase;
<span class="hljs-keyword">import</span> android.content.Context;
<span class="hljs-keyword">import</span> android.os.AsyncTask;

<span class="hljs-keyword">import</span> java.lang.ref.WeakReference;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DatabaseTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AsyncTask</span>&lt;<span class="hljs-title">Object</span>, <span class="hljs-title">Void</span>, <span class="hljs-title">Void</span>&gt;
</span>{
  <span class="hljs-comment">// Room database butuh Context</span>
  <span class="hljs-keyword">private</span> WeakReference&lt;Context&gt; databaseContext; <span class="hljs-comment">// Dimasukkan WeakReference&lt;&gt; untuk Mencegah kebocoran memory</span>

  <span class="hljs-comment">// Activity yang ingin menjalankan operasi database di background secara asynchronous</span>
  <span class="hljs-keyword">private</span> DatabaseTaskEventListener eventListener; 

  <span class="hljs-comment">// Hasil dari operasi yang selesai dilakukan</span>
  <span class="hljs-keyword">private</span> Object operationResult;

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DatabaseTask</span><span class="hljs-params">(Context databaseContext, DatabaseTaskEventListener eventListener)</span>
  </span>{
      <span class="hljs-keyword">this</span>.databaseContext = <span class="hljs-keyword">new</span> WeakReference&lt;&gt;(databaseContext);
      <span class="hljs-keyword">this</span>.eventListener = eventListener;
  }

  <span class="hljs-comment">// Operasi yang dijalankan di background secara Asynchronous</span>
  <span class="hljs-meta">@Override</span>
  <span class="hljs-function"><span class="hljs-keyword">protected</span> Void <span class="hljs-title">doInBackground</span><span class="hljs-params">(Object... objects)</span>
  </span>{
      <span class="hljs-comment">// Mendapatkan instance database asynchronous dari AppDbProvider</span>
      RoomDatabase database = AppDbProvider.getAsynchronousInstance(<span class="hljs-keyword">this</span>.databaseContext.get());

      <span class="hljs-comment">// Melemparkan instance database tadi ke event listener untuk diambil DAO-nya nanti</span>
      <span class="hljs-keyword">this</span>.operationResult = <span class="hljs-keyword">this</span>.eventListener.runDatabaseOperation(database, objects);

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
  }

  <span class="hljs-meta">@Override</span>
  <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPostExecute</span><span class="hljs-params">(Void aVoid)</span>
  </span>{
      <span class="hljs-keyword">super</span>.onPostExecute(aVoid);

      <span class="hljs-comment">// Memberitahukan ke event listener bahwasanya operasi yang dilakukan di-background telah selesai </span>
      <span class="hljs-keyword">this</span>.eventListener.onDatabaseOperationFinished(<span class="hljs-keyword">this</span>.operationResult);
  }
}
</code></pre>
</li>
<li><p>Setelah kedua class dan interface di package data tersebut beres, maka sekarang bukalah file RegisterActivity.java. Pada class tersebut tambahkan property baru untuk menampung indicator loading yang akan dimunculkan nanti saat pengguna mengklik Button &#x2018;Register&#x2019;</p>
<pre><code class="lang-java"><span class="hljs-comment">// Loading indicator untuk ditampilkan saat menyimpan data</span>
ProgressDialog loadingIndicator;
</code></pre>
</li>
<li><p>Selanjutnya tambahkan method baru untuk menampilkan loading indicator.</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">showLoadingIndicator</span><span class="hljs-params">()</span>
</span>{
  loadingIndicator = <span class="hljs-keyword">new</span> ProgressDialog(<span class="hljs-keyword">this</span>);
  loadingIndicator.setMessage(<span class="hljs-string">&quot;Uploading user data to server...&quot;</span>);
  loadingIndicator.setIndeterminate(<span class="hljs-keyword">false</span>);
  loadingIndicator.setCancelable(<span class="hljs-keyword">false</span>);
  loadingIndicator.show();
}
</code></pre>
</li>
<li><p>Comment-lah, atau gantilah nama method action onBtnRegisterNow_Click() agar tidak perlu menghapusnya supaya bisa dipelajari nanti jika diperlukan</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBtnRegisterNow_Click_Old</span><span class="hljs-params">(View view)</span>
</span></code></pre>
</li>
<li><p>Buatlah method onBtnRegisterNow_Click() baru dan isikan didalamnya baris-baris kode berikut.</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBtnRegisterNow_Click</span><span class="hljs-params">(View view)</span>
</span>{
  <span class="hljs-comment">// Tampilkan loading indicator</span>
  <span class="hljs-keyword">this</span>.showLoadingIndicator();

  <span class="hljs-keyword">new</span> DatabaseTask(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">new</span> DatabaseTaskEventListener() {

      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">runDatabaseOperation</span><span class="hljs-params">(RoomDatabase database, Object... params)</span> </span>{

          <span class="hljs-comment">// Mengambil Entity dari params</span>
          User user = (User) params[<span class="hljs-number">0</span>];

          <span class="hljs-comment">// Mendapatkan DAO dari object database, dan memanggil method operasi INSERT</span>
          ((DTSAppDatabase)database).userDao().insertAll(user);

          <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
      }

      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDatabaseOperationFinished</span><span class="hljs-params">(Object... results)</span>
      </span>{
          <span class="hljs-comment">// Delay eksekusi program agar nampak agak lama seolah-olah datanya sedang diunggah</span>
          <span class="hljs-keyword">new</span> Handler().postDelayed(<span class="hljs-keyword">new</span> Runnable(){
              <span class="hljs-meta">@Override</span>
              <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span>{
                  <span class="hljs-comment">// Tutup loading indicator &amp; tampilkan Toast</span>
                  loadingIndicator.dismiss();
                  Toast.makeText(getApplicationContext(), <span class="hljs-string">&quot;Registration success!&quot;</span>, Toast.LENGTH_SHORT).show();
              }
          }, <span class="hljs-number">5000</span>);
      }
  }).execute(<span class="hljs-keyword">this</span>.makeUser());
}
</code></pre>
<p>Secara umum kode yang ada pada action onBtnRegisterNow_Click() ini dibagi menjadi 2 yaitu:</p>
<ul>
<li>Kode pada method anonymous interface runDatabaseOperation() dimana kode pada bagian ini yang menjalankan operasi INSERT dari DAO yang didapat melalui instance Database pada parameternya.</li>
<li>Kode pada method anonymous interface onDatabaseOperationFinished() dimana kode pada bagian tersebut hanya menghilangkan loading indicator setelah delay selama 5 detik.</li>
</ul>
</li>
<li><p>Akhirnya, jalankan kembali aplikasi Anda, apabila tidak ada masalah, maka seharusnya loading indicator akan muncul saat data registrasi disimpan.
<img src="images/register-loading.png" alt="Register loading"></p>
</li>
<li><p>Dan Toast akan dimunculkan saat 5 detik sudah terlewati
<img src="images/register-loading-finished.png" alt="Register loading finished"></p>
</li>
<li><p>Juga, ketika halaman profile dibuka, tetap akan tersimpan data yang tadi diinputkan di halaman Register ASALKAN: data yang sebelumnya sudah dihapus. Jika tidak muncul, HAPUS dulu aplikasi dari emulator/ponsel Anda, kemudian build and run lagi dari Android Studio.
<img src="images/register-async-on-profile.png" alt="Data asynchronous di halaman profile"></p>
</li>
<li><p>Apabila terdapat error, seperti biasa, cek blok import Anda.</p>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> polinema.ac.id.dtsapp;

<span class="hljs-keyword">import</span> android.app.ProgressDialog;
<span class="hljs-keyword">import</span> android.arch.persistence.room.RoomDatabase;
<span class="hljs-keyword">import</span> android.os.Handler;
<span class="hljs-keyword">import</span> android.support.v7.app.AppCompatActivity;
<span class="hljs-keyword">import</span> android.os.Bundle;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.widget.EditText;
<span class="hljs-keyword">import</span> android.widget.Toast;

<span class="hljs-keyword">import</span> polinema.ac.id.dtsapp.data.AppDbProvider;
<span class="hljs-keyword">import</span> polinema.ac.id.dtsapp.data.DTSAppDatabase;
<span class="hljs-keyword">import</span> polinema.ac.id.dtsapp.data.DatabaseTask;
<span class="hljs-keyword">import</span> polinema.ac.id.dtsapp.data.DatabaseTaskEventListener;
<span class="hljs-keyword">import</span> polinema.ac.id.dtsapp.data.User;
<span class="hljs-keyword">import</span> polinema.ac.id.dtsapp.data.UserDao;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegisterActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span>
</span>{
</code></pre>
</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> hasil yang cocok "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">Tidak ada hasil yang cocok "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="chapter09-08delete.html" class="navigation navigation-prev " aria-label="Previous page: Praktikum 5 - Operasi DELETE">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../chapter10/chapter10-01pendahuluan.html" class="navigation navigation-next " aria-label="Next page: Bab 10 Room Persistence Library, RecyclerView">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Praktikum 6 - Operasi Database Asynchronous","level":"1.9.9","depth":2,"next":{"title":"Bab 10 Room Persistence Library, RecyclerView","level":"1.10","depth":1,"path":"chapter10/chapter10-01pendahuluan.md","ref":"chapter10/chapter10-01pendahuluan.md","articles":[{"title":"1 - Architecture Component dan Room Database","level":"1.10.1","depth":2,"path":"chapter10/chapter10-02architecture-component.md","ref":"chapter10/chapter10-02architecture-component.md","articles":[]},{"title":"2 - View Model","level":"1.10.2","depth":2,"path":"chapter10/chapter10-03MembuatViewModel.md","ref":"chapter10/chapter10-03MembuatViewModel.md","articles":[]},{"title":"3 - RecyclerView","level":"1.10.3","depth":2,"path":"chapter10/chapter10-04RecyclerView.md","ref":"chapter10/chapter10-04RecyclerView.md","articles":[]},{"title":"4 - Latihan","level":"1.10.4","depth":2,"path":"chapter10/chapter10-05Latihan.md","ref":"chapter10/chapter10-05Latihan.md","articles":[]}]},"previous":{"title":"Praktikum 5 - Operasi DELETE","level":"1.9.8","depth":2,"path":"chapter09/chapter09-08delete.md","ref":"chapter09/chapter09-08delete.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"id","gitbook":"*"},"file":{"path":"chapter09/chapter09-09asynchronous-database-ops.md","mtime":"2019-07-14T14:59:27.492Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-07-14T21:30:08.981Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

